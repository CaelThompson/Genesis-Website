---
import FrequentBox from '../MadeForProject/FrequentBox.astro';
import { showSuggestions } from '../MadeForProject/autocomplete.js';
import { searchterms } from '../MadeForProject/searchs.js'
const handleFocus = (event) => {
    const target = event.target;
    if (target instanceof HTMLInputElement) {
        showSuggestions(target.value);
    }
};

---
<title>Centered Search Bar</title>
<style>
    .search-container {
        display: flex;
        flex-direction: column;
        justify-content: flex-start; /* Aligns items to the bottom */
        align-items: center;
        height: 50vh;
        width: 100vw;
        border: 2px solid #ccc;
        padding: 20px;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px; /* Adds space at the bottom */
    }
    .search-bar {
        display: flex;
        align-items: center;
        width: 300px;
        margin-bottom: 20px;
        position: relative;
    }
    .search-bar input[type="text"] {
        flex: 1;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px 0 0 4px; /* Rounded corners for the input */
    }
    .search-bar button {
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 0 4px 4px 0; /* Rounded corners for the button */
        background-color: #007bff;
        color: white;
        cursor: pointer;
    }
    .search-bar button:hover {
        background-color: #0056b3;
    }
    .autocomplete-list {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        border: 1px solid #ccc;
        background-color: #fff;
        z-index: 1000;
        max-height: 150px;
        overflow-y: auto;
    }
    .autocomplete-item {
        padding: 10px;
        cursor: pointer;
    }
    .autocomplete-item:hover {
        background-color: #f0f0f0;
    }
</style>

<body>
    <div class="search-container">
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search..." oninput="showSuggestions(this.value)">
            
            <button onclick="executeSearch()">Search</button>
            <div id="autocompleteList" class="autocomplete-list"></div>
        </div>
        <div>
            <FrequentBox />
        </div>
    </div>
    
    <script>
        import { searchterms } from '../MadeForProject/searchs.js';
        const items = searchterms;

        function showSuggestions(query) {
            
            const autocompleteList = document.getElementById('autocompleteList');
            autocompleteList.innerHTML = '';
            if (query.length === 0) {
                return;
                
            }
            console.log('Hello, this is a message from the console!');
            const suggestions = items.filter(item => item.toLowerCase().includes(query.toLowerCase()));
            suggestions.forEach(suggestion => {
   
                const item = document.createElement('div');
                item.className = 'autocomplete-item';
                item.textContent = suggestion;
                item.onclick = () => {
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput instanceof HTMLInputElement) {
                        searchInput.value = suggestion;
                    }
                    autocompleteList.innerHTML = '';
                };
                autocompleteList.appendChild(item);
            });
        }

        function executeSearch() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput instanceof HTMLInputElement) {
                const query = searchInput.value;
                // Add your logic here to handle different options based on the search query
                if (items.includes(query)) {
                    window.location.href = `https://example.com/${query}`;
                } else {
                    alert('No matching option found');
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Ensure showSuggestions runs when the input is focused
            document.getElementById('searchInput').addEventListener('focus', (event) => {
                const target = event.target;
                if (target instanceof HTMLInputElement) {
                    showSuggestions(target.value);
                }
            });
        });

        
        document.getElementById('searchInput').addEventListener('input', (event) => {
            const inputElement = event.target;
            const value = inputElement.value;
            console.log(`You typed: ${value}`);
            showSuggestions(value);

        });


    </script>

</body>

